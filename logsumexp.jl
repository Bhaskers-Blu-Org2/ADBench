#  C:\projects\autodiff\julia\logsumexp.jl
#  AUTOGENERATED FROM C:\projects\autodiff\julia\logsumexp.ipynb on 2015-07-04T22:26:10
using Base.Test

# logsumexp()
function logsumexp(x::Array{Float64,1})
  A = maximum(x);
  ema = exp(x-A);
  sema = sum(ema);
  log(sema) + A;
end

r = rand(5);
@test_approx_eq_eps logsumexp(r) log(sum(exp(r))) 1.0e-8
@printf("logsumexp: %f = %f\n", logsumexp(r), log(sum(exp(r))));


# logsumexp()
function logsumexp_both(x::Array{Float64,1})
  A = maximum(x);
  ema = exp(x-A);
  sema = sum(ema);
  l = log(sema) + A;
  Jacobian = ema/sema;
  return (l, Jacobian);
end

#logsumexp(x::Array{Float64,1}) = logsumexp_both(x)[1]


/*        Generated by TAPENADE     (INRIA, Tropics team)
    Tapenade 3.10 (r5498) - 20 Jan 2015 09:48
*/
#include "../defs.h"
#include "adStack.h"
/*  Hint: NBDirsMax should be the maximum number of differentiation directions
*/
// maximum number of input variables (for dv mode)
// This throws error on n<1
double arr_max(int n, double *x);
void arr_max_b(int n, double *x, double *xb, double arr_maxb);
double logsumexp(int n, double *x);
void logsumexp_b(int n, double *x, double *xb, double logsumexpb);
// p dim
// k number of components
// wishart parameters
// icf  (p*(p+1)/2)*k parametrizing lower triangular 
//					square roots of inverse covariances log of diagonal 
//					is first p params
double log_wishart_prior(int p, int k, Wishart wishart, double *icf);
void log_wishart_prior_b(int p, int k, Wishart wishart, double *icf, double *
    icfb, double log_wishart_priorb);
double log_gamma_distrib(double a, double p);
// d dim
// k number of gaussians
// n number of points
// alphas k logs of mixture weights (unnormalized), so
//			weights = exp(log_alphas) / sum(exp(log_alphas))
// means d*k component means
// icf (d*(d+1)/2)*k parametrizing lower triangular 
//					square roots of inverse covariances log of diagonal 
//					is first d params
// wishart wishart distribution parameters
// x d*n points
// err 1 output
// To generate params in MATLAB given covariance C :
//           L = inv(chol(C, 'lower'));
//           inv_cov_factor = [log(diag(L)); L(au_tril_indices(d, -1))]
void gmm_objective(int d, int k, int n, double *alphas, double *means, double 
    *icf, double *x, Wishart wishart, double *err);
void gmm_objective_b(int d, int k, int n, double *alphas, double *alphasb, 
    double *means, double *meansb, double *icf, double *icfb, double *x, 
    Wishart wishart, double *err, double *errb);
